<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Super Glitch Box</title><style>
body{background:#000}#gamecontainer{margin:0 auto}#game{margin:auto;position:absolute;top:0;left:0;bottom:0;right:0;width:800px;height:600px;border:1px solid #555}canvas,img{border:1px solid #555;image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:optimize-contrast;image-rendering:pixelated;-ms-interpolation-mode:nearest-neighbor;border:5px solid #ddd}
</style></head><body><div id="gamecontainer"><canvas id="game" width="810" height="600"></canvas></div><script>
var GAME=function(){var a=function(){function b(a){return e.appendChild(a.dom),a}function c(a){for(var b=0;b<e.children.length;b++)e.children[b].style.display=b===a?"block":"none";d=a}var d=0,e=document.createElement("div");e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(a){a.preventDefault(),c(++d%e.children.length)},!1);var f=(performance||Date).now(),g=f,h=0,i=b(new a.Panel("FPS","#0ff","#002")),j=b(new a.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var k=b(new a.Panel("MB","#f08","#201"));return c(0),{REVISION:16,dom:e,addPanel:b,showPanel:c,begin:function(){f=(performance||Date).now()},end:function(){h++;var a=(performance||Date).now();if(j.update(a-f,200),a>g+1e3&&(i.update(1e3*h/(a-g),100),g=a,h=0,k)){var b=performance.memory;k.update(b.usedJSHeapSize/1048576,b.jsHeapSizeLimit/1048576)}return a},update:function(){f=this.end()},domElement:e,setMode:c}};a.Panel=function(a,b,c){var d=1/0,e=0,f=Math.round,g=f(window.devicePixelRatio||1),h=80*g,i=48*g,j=3*g,k=2*g,l=3*g,m=15*g,n=74*g,o=30*g,p=document.createElement("canvas");p.width=h,p.height=i,p.style.cssText="width:80px;height:48px";var q=p.getContext("2d");return q.font="bold "+9*g+"px Helvetica,Arial,sans-serif",q.textBaseline="top",q.fillStyle=c,q.fillRect(0,0,h,i),q.fillStyle=b,q.fillText(a,j,k),q.fillRect(l,m,n,o),q.fillStyle=c,q.globalAlpha=.9,q.fillRect(l,m,n,o),{dom:p,update:function(i,r){d=Math.min(d,i),e=Math.max(e,i),q.fillStyle=c,q.globalAlpha=1,q.fillRect(0,0,h,m),q.fillStyle=b,q.fillText(f(i)+" "+a+" ("+f(d)+"-"+f(e)+")",j,k),q.drawImage(p,l+g,m,n-g,o,l,m,n-g,o),q.fillRect(l+n-g,m,g,o),q.fillStyle=c,q.globalAlpha=.9,q.fillRect(l+n-g,m,g,f((1-i/r)*o))}}},"object"==typeof module&&(module.exports=a);var b=0,c=!1,d=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;console.log("firefox? : "+d);var f=[],g=60,h=1/g,i=0,j=M(),k=M(),l={},m={},n={},o=new V(2e3,T),p=new V(25,R),q=new V(100,T),r={GAMEWIDTH:270,GAMEHEIGHT:200,SCALE:3,GRID:10,WIDTH:27,HEIGHT:20,P_SPEED:1,P_JUMP:1,E_SPEED:.5,E_JUMP:.25,GLITCH:{xch:0,xamt:10,ych:0,yamt:10}},s=2,t=0,u=15,v=document.querySelector("#game"),w=v.getContext("2d");w.imageSmoothingEnabled=!1,w.mozImageSmoothingEnabled=!1;var x=document.createElement("canvas");x.width=r.GAMEWIDTH,x.height=r.GAMEHEIGHT;var y=x.getContext("2d"),z=document.createElement("canvas");z.width=r.GAMEWIDTH,z.height=r.GAMEHEIGHT;var A=z.getContext("2d"),B=document.createElement("canvas");B.width=r.GAMEWIDTH,B.height=r.GAMEHEIGHT;var C=B.getContext("2d"),D=document.createElement("canvas");D.width=r.GAMEWIDTH,D.height=r.GAMEHEIGHT;var E=D.getContext("2d");if(!d)var F=G();function G(){var a=document.createElement("canvas"),b=a.getContext("2d");a.width=r.GAMEWIDTH*r.SCALE,a.height=r.GAMEHEIGHT*r.SCALE,b.fillStyle="#808080",b.fillRect(0,0,a.width,a.height);for(var c=0;c<=r.GAMEWIDTH;c++)for(var d=0;d<=r.GAMEHEIGHT;d++)b.fillStyle="#e0e0e0",b.fillRect(c*r.SCALE,d*r.SCALE,2,2),b.fillStyle="#707070",b.fillRect(c*r.SCALE,d*r.SCALE+2,1,1),b.fillStyle="#f8f8f8",b.fillRect(c*r.SCALE+2,d*r.SCALE,1,1);return{canvas:a,context:b}}var H={render:function(a){for(var b=S.map,c=["","oO\nOo","oo\noo","oo\noo"],d=0;d<b.length;d++)for(var e=0;e<b[d].length;e++)b[d][e]&&(a.fillStyle="#75A",Txt.text({ctx:a,x:e*r.GRID,y:d*r.GRID,text:c[b[d][e]],hspacing:0,vspacing:0,halign:"top",valign:"left",scale:1,snap:1,render:1,glitch:r.GLITCH}))}};function I(a,b){return Math.random()*(b-a+1)+a}function J(a,b){for(var c="",d=b;d--;)c+=a.charAt(Math.floor(Math.random()*a.length));return c}function K(a,b,c){return(a-b)/(c-b)}function L(){o.init(),q.init(),p.init(),m=Q.create({initial:"init",events:[{name:"load",from:"init",to:"boot"},{name:"ready",from:"boot",to:"menu"},{name:"play",from:["menu","gameover"],to:"game"},{name:"lose",from:["game","gameover"],to:"gameover"},{name:"reset",from:["init","boot","menu","gameover","game"],to:"boot"}],callbacks:{onenterboot:function(a,b,c){n.boot.onenter(a,b,c)},onentermenu:function(a,b,c){n.menu.onenter(a,b,c)},onleavemenu:function(a,b,c){n.menu.onexit(a,b,c)},onentergame:function(a,b,c){n.game.onenter(a,b,c)},onleavegame:function(a,b,c){n.game.onexit(a,b,c)},onentergameover:function(a,b,c){n.gameover.onenter(a,b,c)}}}),window.addEventListener("keyup",function(a){Key.onKeyup(a)},!1),window.addEventListener("keydown",function(a){Key.onKeydown(a)},!1),window.addEventListener("blur",function(){c=!0},!1),window.addEventListener("focus",function(){c=!1},!1),m.load(),O()}function M(){return(new Date).getTime()}initAudio=function(){l.loaded=0,l.total=8,window.AudioContext=window.AudioContext||window.webkitAudioContext,$=new AudioContext,soundGen=new W.SoundGenerator(S.sounds.jump),soundGen.createAudioBuffer(171,function(a){l.loaded++,l.jump=a}),soundGen=new W.SoundGenerator(S.sounds.shoot),soundGen.createAudioBuffer(147,function(a){l.loaded++,l.shoot=a}),soundGen=new W.SoundGenerator(S.sounds.boom),soundGen.createAudioBuffer(147,function(a){l.loaded++,l.boom=a}),soundGen=new W.SoundGenerator(S.sounds.sizzle),soundGen.createAudioBuffer(147,function(a){l.loaded++,l.sizzle=a}),soundGen=new W.MusicGenerator(S.song),soundGen.createAudioBuffer(function(a){l.song=a,l.loaded++}),soundGen=new W.MusicGenerator(S.titlesong),soundGen.createAudioBuffer(function(a){l.titlesong=a,l.loaded++}),soundGen=new W.MusicGenerator(S.gameover),soundGen.createAudioBuffer(function(a){l.gameover=a,l.loaded++}),soundGen=new W.MusicGenerator(S.glitchget),soundGen.createAudioBuffer(function(a){l.glitchget=a,l.loaded++})};function N(a,b,c,d){var e=$.createBufferSource(),f=$.createGain(),g=$.createStereoPanner();return e.buffer=a,e.connect(g),g.connect(f),f.connect($.destination),e.playbackRate.value=b,e.loop=d,f.gain.value=1,g.pan.value=c,e.start(),{volume:f,sound:e}}function O(){if(c)C.fillStyle="rgba(0,0,0, 0.5)",C.fillRect(0,0,r.GAMEWIDTH,r.GAMEHEIGHT),C.fillStyle="#0c0",Txt.text({ctx:C,x:r.GAMEWIDTH/2,y:r.GAMEHEIGHT/2,text:"PAUSED",hspacing:5,vspacing:0,halign:"center",valign:"center",scale:5,snap:1,render:1,glitch:r.GLITCH});else{for(j=M(),i+=Math.min(1,(j-k)/1e3),n[m.current].render(A);i>h;)i-=h,n[m.current].update(h);k=j}E.drawImage(x,0,0),E.drawImage(z,0,0),E.drawImage(B,0,0),w.save(),w.fillStyle="black",w.fillRect(0,0,r.GAMEWIDTH*r.SCALE,r.GAMEHEIGHT*r.SCALE),w.drawImage(D,0,0,r.GAMEWIDTH,r.GAMEHEIGHT,0,0,r.GAMEWIDTH*r.SCALE,r.GAMEHEIGHT*r.SCALE),w.restore(),w.save(),d||(w.globalCompositeOperation="overlay",w.drawImage(F.canvas,0,0)),w.restore(),w.globalCompositeOperation="source-over",requestAnimationFrame(O)}function P(){E.clearRect(0,0,r.GAMEWIDTH,r.GAMEHEIGHT),y.clearRect(0,0,r.GAMEWIDTH,r.GAMEHEIGHT),A.clearRect(0,0,r.GAMEWIDTH,r.GAMEHEIGHT),C.clearRect(0,0,r.GAMEWIDTH,r.GAMEHEIGHT)}var Q={VERSION:"2.3.5",Result:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},Error:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},WILDCARD:"*",ASYNC:"async",create:function(a,b){var c="string"==typeof a.initial?{state:a.initial}:a.initial,d=a.terminal||a.final,e=b||a.target||{},f=a.events||[],g=a.callbacks||{},h={},i={},j=function(a){var b=a.from instanceof Array?a.from:a.from?[a.from]:[Q.WILDCARD];h[a.name]=h[a.name]||{};for(var c=0;c<b.length;c++)i[b[c]]=i[b[c]]||[],i[b[c]].push(a.name),h[a.name][b[c]]=a.to||b[c]};c&&(c.event=c.event||"startup",j({name:c.event,from:"none",to:c.state}));for(var k=0;k<f.length;k++)j(f[k]);for(var l in h)h.hasOwnProperty(l)&&(e[l]=Q.buildEvent(l,h[l]));for(var l in g)g.hasOwnProperty(l)&&(e[l]=g[l]);return e.current="none",e.is=function(a){return a instanceof Array?a.indexOf(this.current)>=0:this.current===a},e.can=function(a){return!this.transition&&(h[a].hasOwnProperty(this.current)||h[a].hasOwnProperty(Q.WILDCARD))},e.cannot=function(a){return!this.can(a)},e.transitions=function(){return i[this.current]},e.isFinished=function(){return this.is(d)},e.error=a.error||function(a,b,c,d,e,f,g){throw g||f},c&&!c.defer&&e[c.event](),e},doCallback:function(a,b,c,d,e,f){if(b)try{return b.apply(a,[c,d,e].concat(f))}catch(g){return a.error(c,d,e,f,Q.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",g)}},beforeAnyEvent:function(a,b,c,d,e){return Q.doCallback(a,a.onbeforeevent,b,c,d,e)},afterAnyEvent:function(a,b,c,d,e){return Q.doCallback(a,a.onafterevent||a.onevent,b,c,d,e)},leaveAnyState:function(a,b,c,d,e){return Q.doCallback(a,a.onleavestate,b,c,d,e)},enterAnyState:function(a,b,c,d,e){return Q.doCallback(a,a.onenterstate||a.onstate,b,c,d,e)},changeState:function(a,b,c,d,e){return Q.doCallback(a,a.onchangestate,b,c,d,e)},beforeThisEvent:function(a,b,c,d,e){return Q.doCallback(a,a["onbefore"+b],b,c,d,e)},afterThisEvent:function(a,b,c,d,e){return Q.doCallback(a,a["onafter"+b]||a["on"+b],b,c,d,e)},leaveThisState:function(a,b,c,d,e){return Q.doCallback(a,a["onleave"+c],b,c,d,e)},enterThisState:function(a,b,c,d,e){return Q.doCallback(a,a["onenter"+d]||a["on"+d],b,c,d,e)},beforeEvent:function(a,b,c,d,e){return!1===Q.beforeThisEvent(a,b,c,d,e)||!1===Q.beforeAnyEvent(a,b,c,d,e)?!1:void 0},afterEvent:function(a,b,c,d,e){Q.afterThisEvent(a,b,c,d,e),Q.afterAnyEvent(a,b,c,d,e)},leaveState:function(a,b,c,d,e){var f=Q.leaveThisState(a,b,c,d,e),g=Q.leaveAnyState(a,b,c,d,e);return!1===f||!1===g?!1:Q.ASYNC===f||Q.ASYNC===g?Q.ASYNC:void 0},enterState:function(a,b,c,d,e){Q.enterThisState(a,b,c,d,e),Q.enterAnyState(a,b,c,d,e)},buildEvent:function(a,b){return function(){var c=this.current,d=b[c]||b[Q.WILDCARD]||c,e=Array.prototype.slice.call(arguments);if(this.transition)return this.error(a,c,d,e,Q.Error.PENDING_TRANSITION,"event "+a+" inappropriate because previous transition did not complete");if(this.cannot(a))return this.error(a,c,d,e,Q.Error.INVALID_TRANSITION,"event "+a+" inappropriate in current state "+this.current);if(!1===Q.beforeEvent(this,a,c,d,e))return Q.Result.CANCELLED;if(c===d)return Q.afterEvent(this,a,c,d,e),Q.Result.NOTRANSITION;var f=this;this.transition=function(){return f.transition=null,f.current=d,Q.enterState(f,a,c,d,e),Q.changeState(f,a,c,d,e),Q.afterEvent(f,a,c,d,e),Q.Result.SUCCEEDED},this.transition.cancel=function(){f.transition=null,Q.afterEvent(f,a,c,d,e)};var g=Q.leaveState(this,a,c,d,e);return!1===g?(this.transition=null,Q.Result.CANCELLED):Q.ASYNC===g?Q.Result.PENDING:this.transition?this.transition():void 0}}};n.game={onenter:function(a,c){switch(d&&o.init(),c){case"menu":player=new Player({x:r.GAMEWIDTH/2,y:100}),glitchbox=new Glitchbox({x:70,y:100}),song=N(l.song,1,0,!1);break;case"gameover":b=0,player.body.setCoords(r.GAMEWIDTH/2,100),song=N(l.song,1,0,!0),p.init(),o.init(),q.init(),r.GLITCH={xch:0,xamt:10,ych:0,yamt:10}}},onexit:function(){song.sound.stop()},render:function(){P(GAME),y.fillStyle="#204",Txt.text({ctx:y,x:10,y:0,text:"o o o\n o o \no o o\n o o ",hspacing:0,vspacing:0,halign:"top",valign:"left",scale:10,snap:1,render:1,glitch:r.GLITCH}),y.fillStyle="#102",d||(y.globalCompositeOperation="screen"),Txt.text({ctx:y,x:10,y:0,text:"ooooooooooo\nooooooooooo\nooooooooooo\nooooooooooo\nooooooooooo\nooooooooooo\nooooooooooo\nooooooooooo",hspacing:0,vspacing:0,halign:"top",valign:"left",scale:5,snap:1,render:1,glitch:r.GLITCH}),y.globalCompositeOperation="source-over",Txt.text({ctx:C,x:r.GAMEWIDTH/2,y:10,text:""+b,color:"#c90",hspacing:2,vspacing:1,halign:"center",valign:"center",scale:2,snap:1,render:1,glitch:r.GLITCH}),H.render(A),player.render(A),glitchbox.render(A)},update:function(a){o.get({x:110+50*Math.random(),y:205,mapcollide:!0,gravity:-.004,radius:4,color:"#a20",life:.8}),t-=a,t>0||(p.get({x:r.GAMEWIDTH/2,y:0}),t=s),player.update(a),glitchbox.update(a),player.body.update(a),glitchbox.body.update(a),o.use(),p.use(),q.use();for(var b=p.getPool().slice(),c=q.getPool().slice(),d=0;d<b.length;d++)for(var e=0;e<c.length;e++)b[d].inUse&&c[e].inUse&&Entity.prototype.overlaps(b[d].body,c[e].body)&&(b[d].dead=!0,c[e].dead=!0);for(var e=0;e<b.length;e++)b[e].inUse&&Entity.prototype.overlaps(player.body,b[e].body)&&player.die();Entity.prototype.overlaps(player.body,glitchbox.body)&&(glitchbox.die(),player.currentGun=player.makeGun())}},n.menu={onenter:function(a){"ready"==a&&(titlesong=N(l.titlesong,1,0,!0))},onexit:function(a){"play"==a&&titlesong.sound.stop()},render:function(){P(GAME),C.fillStyle="#e80",Txt.text({ctx:C,x:r.GAMEWIDTH/2,y:20,text:"SUPER\n\nBOX",hspacing:2,vspacing:5,halign:"center",valign:"top",scale:5,snap:1,render:1}),C.fillStyle="#cc0",Txt.text({ctx:C,x:r.GAMEWIDTH/2,y:50,text:"GLITCH",hspacing:2,vspacing:2,halign:"center",valign:"top",scale:5,snap:1,render:1,glitch:{xch:.1,xamt:10,ych:0,yamt:0}}),C.save(),C.fillStyle="#fff",Txt.text({ctx:C,x:r.GAMEWIDTH/2,y:150,text:"A+D/ARROWS: MOVE\nSPACE/Z: SHOOT   X:JUMP\nPRESS Z TO PLAY",hspacing:2,vspacing:2,halign:"center",valign:"top",scale:1,snap:1,render:1}),C.restore()},update:function(){if(Key.isDown(Key.z)&&"menu"==m.current&&m.play(),!d)for(var a=2;a--;)o.get({x:Math.random()*r.GAMEWIDTH,y:220,mapcollide:!1,collides:!1,gravity:-.03,radius:I(2,20),color:"rgba(20,0,40, 1)",life:5});o.use()}},n.boot={onenter:function(){l.jump||initAudio()},render:function(){P(GAME),f=[];for(var a=r.WIDTH;a--;)C.fillStyle="#020",Txt.text({ctx:C,x:a*(r.GRID+2),y:70,text:J("wesdxz",2)+"\n"+J("wesdxz",2)+"\n"+J("wesdxz",2),hspacing:1,vspacing:1,halign:"top",valign:"left",scale:1,snap:1,render:1});var b=["INITIALIZING...","RENDERING SOUNDS...","CONFIGURATING PIXELS....","RETICULATING SPLINES...","MESSAGE 42","STIRRING THE PARTICLE POOL...","STIRRING THE PARTICLE POOL...","BREEDING BADDIES...","READY. PRESS X TO CONTINUE"];w.clearRect(0,0,r.GAMEWIDTH,r.GAMEHEIGHT),C.fillStyle=7==l.loaded?"#0d0":"#080",Txt.text({ctx:C,x:18,y:79,text:b[l.loaded],hspacing:1,vspacing:1,halign:"top",valign:"center",scale:1,snap:1,render:1,glitchChance:0,glitchFactor:0})},update:function(){Key.isDown(Key.r)&&m.current&&m.reset(),l.loaded==l.total&&Key.isDown(Key.x)&&"boot"==m.current&&m.ready()}},n.gameover={onenter:function(){u=15,N(l.gameover,1,0,!1)},render:function(){C.clearRect(0,0,r.GAMEWIDTH,r.GAMEHEIGHT),C.fillStyle="rgba(0,0,0, .75)",Txt.text({ctx:C,x:r.GAMEWIDTH/2,y:0,text:"yyyyyy\nyyyyyy\nyyyyyy\nyyyyyy",hspacing:0,vspacing:0,halign:"center",valign:"left",scale:10,snap:1,render:1,glitch:{xch:0,ych:1,yamt:u,xamt:0}}),C.fillStyle="#f80",Txt.text({ctx:C,x:r.GAMEWIDTH/2,y:65,text:"GAME OVER",hspacing:2,vspacing:5,halign:"center",valign:"left",scale:4,snap:1,render:1,glitch:{xch:0,ych:1,yamt:u,xamt:0}}),C.fillStyle="#bbb",Txt.text({ctx:C,x:r.GAMEWIDTH/2,y:100,text:"YOU COLLECTED "+b+" GLITCHES.\nS: SHARE YOUR SCORE VIA TWITTER\nX: PLAY AGAIN",hspacing:2,vspacing:5,halign:"center",valign:"left",scale:1,snap:1,render:1,glitch:{xch:0,ych:1,yamt:u,xamt:0}})},update:function(){u>0&&(u-=.5),Key.isDown(Key.x)&&"gameover"==m.current&&m.play(),Key.isDown(Key.s)&&window.open("https://twitter.com/intent/tweet?text=text%3DI%20just%20collected%20"+b+"%20glitches%20in%20Super%20Glitch%20Box%2C%20A%20%23js13k%20game%20by%20%40ryanmalm%20%20http%3A%2F%2Fbit.ly%2F2c7P6pm","_self")}},Player=function(a){this.body=new Entity({radius:8,type:"player",collides:!0,mapcollide:!0,gravity:.04}),this.body.setCoords(a.x,a.y),this.fl=!0,this.cooldown=0,this.justJumped=!1,this.justFired=!1,this.currentGun=null,Player.prototype.update=function(a){this.currentGun||(this.currentGun=this.makeGun()),player.currentGun.bullet.x=player.body.xx,player.currentGun.bullet.y=player.body.yy,player.currentGun.bullet.dx=this.fl?-player.currentGun.velocity:player.currentGun.velocity,this.cooldown-=a,Key.isDown(Key.LEFT)||Key.isDown(Key.a)?(this.fl=!0,player.body.dx-=r.P_SPEED*a):(Key.isDown(Key.RIGHT)||Key.isDown(Key.d))&&(this.fl=!1,player.body.dx+=r.P_SPEED*a),(Key.isDown(Key.UP)||Key.isDown(Key.w)||Key.isDown(Key.x))&&(this.body.onGround()&&(player.body.dy=-r.P_JUMP,player.justJumped=!0),player.justJumped&&(player.justJumped=!1,N(l.jump,I(.7,1.1),K(player.body.xx,0,r.GAMEWIDTH),!1))),player.body.yy>200&&player.die(),player.body.yy<5&&player.body.setCoords(this.body.xx,5),(Key.isDown(Key.SPACE)||Key.isDown(Key.z))&&(this.cooldown>0||(this.justFired=!0,q.get(this.currentGun.bullet),this.cooldown=this.currentGun.cooldown,this.justFired&&(this.justFired=!1,N(l.shoot,I(.95,1.1),K(player.body.xx,0,r.GAMEWIDTH)))))}},Player.prototype.render=function(a){a.save(),a.fillStyle="#ea0",player.fl&&a.scale(-1,1),Txt.text({ctx:a,x:player.fl?-1*(player.body.xx+player.body.radius):player.body.xx-player.body.radius,y:player.body.yy-player.body.radius-3,text:"tyu\nghj\nbnm",hspacing:Math.abs(15*player.body.dx),vspacing:Math.abs(15*player.body.dy),halign:"top",valign:"left",scale:1,snap:1,render:1,glitch:{xch:Math.abs(player.body.dx),xamt:5,ych:Math.abs(player.body.dy),yamt:5}}),a.restore()},Player.prototype.die=function(){U("player",this.body),player.body.setCoords(100,100),m.lose()},Player.prototype.makeGun=function(){var a=1.1*Math.random()+.5,b=.2*Math.random()+.02;return bullet={x:0,y:0,mapcollide:!0,collides:!1,gravity:0,frictX:0,frictY:0,dy:0,dx:0,radius:Math.floor(I(1,15)),color:"#f80",life:I(.5,3)},{bullet:bullet,cooldown:b,velocity:a}};function R(){this.inUse=!1,this.init=function(){this.body=new Entity({dead:!0,gravity:0}),this.body.setCoords(-1e3,-1e3)},R.prototype.spawn=function(a){this.inUse=!0,this.sizzled=!1,this.body.radius=Math.floor(I(3,9)),this.body.dead=!1,this.dead=!1,this.body.mapcollide=!0,this.onFire=!1,this.fireSpeed=0,this.bump=0,this.body.gravity=.06,this.movingLeft=Math.random()>.5,this.stridetick=0,this.antennae=Math.random()>.5,this.fill="#3"+J("4567789abcd",1)+"0",this.stroke="#3"+J("4567789abcd",1)+J("123",1),this.angryFill="#"+J("4567789abcd",1)+"00",this.angryStroke="#"+J("4567789abcd",1)+"00",this.body.setCoords(a.x,a.y)},R.prototype.use=function(a){return this.dead?(U("enemy",this.body),U("smoke",this.body),N(l.boom,I(.98,1.05),K(this.body.xx,0,r.GAMEWIDTH),!1),!0):(this.render(A),this.update(a),this.body.update(a),!1)},R.prototype.update=function(a){this.bump>0&&(this.bump-=.01),r.GLITCH.ych=this.bump,this.onFire?o.get({x:this.body.xx+this.body.radius-Math.random()*this.body.radius*2,y:this.body.yy-this.body.radius-2,mapcollide:!0,gravity:-.04,radius:4,color:"#a00",life:.4}):o.get({x:this.body.xx+this.body.radius-Math.random()*this.body.radius*2,y:this.body.yy-this.body.radius-2,mapcollide:!0,gravity:-.03,radius:2,color:"#080",life:.4}),this.stridetick+=.3,this.stride=2*Math.sin(this.stridetick),this.stride2=1.3*Math.sin(this.stridetick-.8),this.fireSpeed=this.onFire?2:1,this.movingLeft?this.body.dx-=r.E_SPEED*this.fireSpeed*a:this.body.dx+=r.E_SPEED*this.fireSpeed*a,this.body.onWallLeft()&&(this.movingLeft=!1),this.body.onWallRight()&&(this.movingLeft=!0),this.body.collided&&(this.movingLeft=!this.movingLeft,this.body.collided=!1),this.body.yy>r.GAMEHEIGHT&&!this.dead&&(this.body.setCoords(r.GAMEWIDTH/2,-5),this.bump=.9,this.onFire=!0,this.sizzled=!0),this.sizzled&&(N(l.sizzle,1,0,!1),this.sizzled=!1)},R.prototype.clear=function(){this.inUse=!1,this.body.xx=-1e3,this.body.xx=-1e3,this.body.dead=!0,this.body.collides=!1,this.body.mapcollide=!1,this.onFire=!1,this.bump=0},R.prototype.render=function(a){a.fillStyle=this.onFire?this.angryFill:this.fill,a.strokeStyle=this.onFire?this.angryStroke:this.fill,a.save(),a.translate(.5,-3.5),a.fillRect(this.body.xx-this.body.radius,this.body.yy-this.body.radius-this.stride,2*this.body.radius,2*this.body.radius+this.stride),a.strokeRect(this.body.xx-this.body.radius,this.body.yy-this.body.radius-this.stride,2*this.body.radius,2*this.body.radius)+this.stride,a.restore(),a.fillStyle="#FFF",a.fillRect(this.body.xx-2,this.body.yy-4-this.stride2,this.onFire?2:1,2),a.fillRect(this.body.xx+2,this.body.yy-4-this.stride2,this.onFire?2:1,2),a.fillStyle="#Fa0",this.antennae&&(a.fillRect(this.body.xx-3,this.body.yy-11-this.stride2,1,5),a.fillRect(this.body.xx+3,this.body.yy-11-this.stride2,1,5))}}Glitchbox=function(){this.body=new Entity({radius:8,collides:!1,mapcollide:!0,gravity:.05}),this.body.setCoords(70,100),this.fl=!0,this.cooldown=0,this.justJumped=!1,this.justFired=!1,this.type="glitchbox",this.bump=0,this.locations=[{cx:10,cy:2},{cx:6,cy:2},{cx:2,cy:7},{cx:5,cy:7},{cx:8,cy:7},{cx:18,cy:7},{cx:24,cy:7},{cx:9,cy:12},{cx:14,cy:12},{cx:18,cy:12},{cx:2,cy:16},{cx:10,cy:17},{cx:18,cy:17},{cx:24,cy:16}]},Glitchbox.prototype.update=function(){this.bump>0&&(this.bump-=.01),r.GLITCH.xch=this.bump,o.get({x:this.body.xx-this.body.radius-1+15*Math.random(),y:this.body.yy-5,mapcollide:!1,gravity:-.006,radius:1,type:"glitch",life:1})},Glitchbox.prototype.render=function(a){a.fillStyle="#"+J("456789ABCDEF",3),Txt.text({ctx:a,x:this.body.xx-this.body.radius,y:this.body.yy-this.body.radius-3,text:"dos\noOo\neow",hspacing:-1+5*r.GLITCH.ych,vspacing:-1,halign:"top",valign:"center",scale:1,snap:1,render:1,glitch:r.GLITCH})},Glitchbox.prototype.die=function(){this.bump=.5,b++,r.GLITCH.ych+=.005,N(l.glitchget,I(.98,1.02),K(this.body.xx,0,r.GAMEWIDTH),!1),U("glitchbox",this.body);var a=this.locations[Math.floor(I(0,this.locations.length-1))];glitchbox.body.setCoords(a.cx*r.GRID,a.cy*r.GRID)},Key={_pressed:{},_released:{},LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,a:65,w:87,s:83,d:68,z:90,x:88,f:70,p:80,r:82,isDown:function(a){return this._pressed[a]},justReleased:function(a){return this._released[a]},onKeydown:function(a){this._pressed[a.keyCode]=!0},onKeyup:function(a){this._released[a.keyCode]=!0,delete this._pressed[a.keyCode]},update:function(){this._released={}}};var S={map:[[1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,2,1,1,1,1,1,1,1,3,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,3,0,0,0,0,0,0,0,2,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,2,1,1,1,1,1,1,1,3,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1]],sounds:{jump:{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:192,osc1_waveform:2,osc2_oct:7,osc2_det:0,osc2_detune:0,osc2_xenv:1,osc2_vol:201,osc2_waveform:0,noise_fader:0,env_attack:7105,env_sustain:150,env_release:0,env_master:191,fx_filter:2,fx_freq:5839,fx_resonance:254,fx_delay_time:1,fx_delay_amt:16,fx_pan_freq:6,fx_pan_amt:128,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:6,lfo_amt:195,lfo_waveform:0},shoot:{osc1_oct:7,osc1_det:1,osc1_detune:0,osc1_xenv:1,osc1_vol:192,osc1_waveform:1,osc2_oct:7,osc2_det:0,osc2_detune:64,osc2_xenv:1,osc2_vol:192,osc2_waveform:2,noise_fader:27,env_attack:0,env_sustain:351,env_release:7916,env_master:135,fx_filter:0,fx_freq:11025,fx_resonance:255,fx_delay_time:1,fx_delay_amt:41,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0},boom:{osc1_oct:7,osc1_det:1,osc1_detune:0,osc1_xenv:1,osc1_vol:192,osc1_waveform:3,osc2_oct:7,osc2_det:0,osc2_detune:64,osc2_xenv:1,osc2_vol:192,osc2_waveform:2,noise_fader:115,env_attack:0,env_sustain:663,env_release:21074,env_master:135,fx_filter:0,fx_freq:11025,fx_resonance:255,fx_delay_time:1,fx_delay_amt:91,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0},sizzle:{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:192,osc1_waveform:2,osc2_oct:7,osc2_det:0,osc2_detune:0,osc2_xenv:1,osc2_vol:192,osc2_waveform:3,noise_fader:159,env_attack:927,env_sustain:2418,env_release:16584,env_master:172,fx_filter:3,fx_freq:11025,fx_resonance:198,fx_delay_time:0,fx_delay_amt:0,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0}},song:{rowLen:2756,endPattern:21,songData:[{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:255,osc1_waveform:0,osc2_oct:7,osc2_det:0,osc2_detune:0,osc2_xenv:1,osc2_vol:255,osc2_waveform:0,noise_fader:0,env_attack:50,env_sustain:150,env_release:4800,env_master:88,fx_filter:2,fx_freq:600,fx_resonance:128,fx_delay_time:0,fx_delay_amt:0,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0,p:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[147,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,147,0,0,0,0,0,0,0,147,0,0,0,0,0,0,0]}]},{osc1_oct:8,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:82,osc1_waveform:2,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:0,osc2_waveform:0,noise_fader:255,env_attack:100,env_sustain:0,env_release:1776,env_master:111,fx_filter:3,fx_freq:5200,fx_resonance:63,fx_delay_time:0,fx_delay_amt:0,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0,p:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[0,0,152,0,152,0,152,0,0,0,152,0,152,0,152,0,0,0,152,0,152,0,152,0,0,0,152,0,152,0,152,0]}]},{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:192,osc1_waveform:1,osc2_oct:6,osc2_det:0,osc2_detune:9,osc2_xenv:0,osc2_vol:192,osc2_waveform:1,noise_fader:0,env_attack:0,env_sustain:2e3,env_release:2653,env_master:166,fx_filter:2,fx_freq:982,fx_resonance:89,fx_delay_time:2,fx_delay_amt:25,fx_pan_freq:6,fx_pan_amt:61,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:3,lfo_amt:69,lfo_waveform:0,p:[1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4],c:[{n:[135,0,0,0,0,0,135,0,0,0,0,0,135,0,0,0,0,0,135,0,0,0,0,0,140,0,0,0,139,0,0,0]},{n:[133,0,0,0,0,0,133,0,0,0,0,0,133,0,0,0,0,0,133,0,0,0,0,0,140,0,0,0,139,0,0,0]},{n:[132,0,0,0,0,0,132,0,0,0,0,0,132,0,0,0,0,0,132,0,0,0,0,0,140,0,0,0,139,0,0,0]},{n:[131,0,0,0,0,0,131,0,0,0,0,0,131,0,0,0,0,0,131,0,0,0,0,0,133,0,0,0,130,0,0,0]}]},{osc1_oct:8,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:160,osc1_waveform:0,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:1,osc2_vol:160,osc2_waveform:0,noise_fader:210,env_attack:50,env_sustain:200,env_release:1403,env_master:79,fx_filter:4,fx_freq:11025,fx_resonance:254,fx_delay_time:1,fx_delay_amt:32,fx_pan_freq:5,fx_pan_amt:61,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:4,lfo_amt:60,lfo_waveform:0,p:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[0,0,0,0,0,0,0,0,147,0,0,0,0,0,0,0,0,0,0,0,0,0,147,0,0,0,0,0,0,0,0,0]}]}],songLen:42},titlesong:{rowLen:6963,endPattern:5,songData:[{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:192,osc1_waveform:2,osc2_oct:7,osc2_det:0,osc2_detune:13,osc2_xenv:0,osc2_vol:192,osc2_waveform:3,noise_fader:0,env_attack:0,env_sustain:5614,env_release:0,env_master:28,fx_filter:0,fx_freq:11025,fx_resonance:255,fx_delay_time:0,fx_delay_amt:0,fx_pan_freq:1,fx_pan_amt:60,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:8,lfo_amt:191,lfo_waveform:2,p:[1,1,1,1],c:[{n:[123,0,0,123,0,0,123,123,123,121,0,121,0,0,121,121,121,120,0,120,0,0,120,120,119,0,0,118,0,0,114,113]}]},{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:255,osc1_waveform:0,osc2_oct:7,osc2_det:0,osc2_detune:0,osc2_xenv:1,osc2_vol:255,osc2_waveform:0,noise_fader:29,env_attack:50,env_sustain:150,env_release:4800,env_master:195,fx_filter:2,fx_freq:600,fx_resonance:192,fx_delay_time:1,fx_delay_amt:0,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:0,lfo_amt:0,lfo_waveform:2,p:[1,1,1,1],c:[{n:[123,0,0,0,123,0,0,0,123,0,0,0,123,0,0,0,123,0,0,0,123,0,0,0,123,0,0,0,123,0,0,0]}]},{osc1_oct:8,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:82,osc1_waveform:2,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:0,osc2_waveform:0,noise_fader:255,env_attack:100,env_sustain:0,env_release:1234,env_master:186,fx_filter:3,fx_freq:10121,fx_resonance:64,fx_delay_time:0,fx_delay_amt:24,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0,p:[1,1,1,1],c:[{n:[0,123,123,123,0,123,123,123,0,123,123,123,0,123,123,123,0,123,123,123,0,123,123,123,0,123,123,123,0,123,123,123]}]},{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:192,osc1_waveform:1,osc2_oct:6,osc2_det:0,osc2_detune:9,osc2_xenv:0,osc2_vol:192,osc2_waveform:1,noise_fader:0,env_attack:137,env_sustain:2e3,env_release:4611,env_master:124,fx_filter:1,fx_freq:982,fx_resonance:89,fx_delay_time:6,fx_delay_amt:25,fx_pan_freq:6,fx_pan_amt:77,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:4,lfo_amt:163,lfo_waveform:3,p:[1,2,1,2],c:[{n:[159,154,159,162,0,161,159,157,0,0,0,0,0,0,159,157,156,152,156,162,0,161,159,161,0,0,0,0,0,0,0,0]},{n:[166,164,162,159,0,154,162,159,161,157,154,0,0,154,159,154,155,154,152,147,0,149,150,149,0,0,0,0,0,0,0,0]}]},{osc1_oct:8,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:221,osc1_waveform:3,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:1,osc2_vol:210,osc2_waveform:3,noise_fader:255,env_attack:50,env_sustain:150,env_release:7505,env_master:127,fx_filter:3,fx_freq:7355,fx_resonance:206,fx_delay_time:2,fx_delay_amt:24,fx_pan_freq:1,fx_pan_amt:142,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:7,lfo_amt:64,lfo_waveform:0,p:[1,1,1,1],c:[{n:[0,0,0,0,123,0,0,0,0,0,0,0,123,0,0,0,0,0,0,0,123,0,0,0,0,0,0,0,123,0,0,0]}]},{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:192,osc1_waveform:3,osc2_oct:7,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:160,osc2_waveform:0,noise_fader:0,env_attack:100,env_sustain:150,env_release:13636,env_master:59,fx_filter:2,fx_freq:5839,fx_resonance:254,fx_delay_time:6,fx_delay_amt:28,fx_pan_freq:6,fx_pan_amt:147,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:4,lfo_amt:195,lfo_waveform:3,p:[1,1,1,1],c:[{n:[142,138,142,138,142,138,142,138,140,137,140,137,140,137,140,137,138,135,138,135,138,135,138,135,137,134,137,134,137,134,137,134]}]}],songLen:27},gameover:{rowLen:2756,endPattern:2,songData:[{osc1_oct:8,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:170,osc1_waveform:1,osc2_oct:5,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:0,osc2_waveform:3,noise_fader:0,env_attack:100,env_sustain:0,env_release:2193,env_master:232,fx_filter:2,fx_freq:559,fx_resonance:135,fx_delay_time:6,fx_delay_amt:117,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0,p:[1],c:[{n:[137,140,144,149,132,137,140,145,128,131,135,140,123,126,130,135,118,121,125,130,0,0,0,0,0,0,0,0,0,0,0,0]}]}],songLen:4},glitchget:{rowLen:2756,endPattern:2,songData:[{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:192,osc1_waveform:1,osc2_oct:6,osc2_det:0,osc2_detune:9,osc2_xenv:0,osc2_vol:192,osc2_waveform:1,noise_fader:0,env_attack:137,env_sustain:2e3,env_release:4611,env_master:192,fx_filter:1,fx_freq:982,fx_resonance:89,fx_delay_time:6,fx_delay_amt:25,fx_pan_freq:6,fx_pan_amt:77,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:3,lfo_amt:69,lfo_waveform:0,p:[1],c:[{n:[147,151,154,159,152,156,159,164,154,158,161,166,173,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}]}],songLen:4},letters:{".":[[,,,,0],[,,,,0],[,,,,0],[,,,,0],[,,1,,0]],1:[[,1,1,,0],[,,1,,0],[,,1,,0],[,,1,,0],[1,1,1,1,1]],2:[[1,1,1,1,0],[,,,,1],[,1,1,1,0],[1,,,,0],[1,1,1,1,1]],3:[[1,1,1,1,0],[,,,,1],[,1,1,1,1],[,,,,1],[1,1,1,1,0]],4:[[1,,,1,0],[1,,,1,0],[1,1,1,1,1],[,,,1,0],[,,,1,0]],5:[[1,1,1,1,1],[1,,,,0],[1,1,1,1,0],[,,,,1],[1,1,1,1,0]],6:[[,1,1,1,0],[1,,,,0],[1,1,1,1,0],[1,,,,1],[,1,1,1,0]],7:[[1,1,1,1,1],[,,,,1],[,,,1,0],[,,1,,0],[,,1,,0]],8:[[,1,1,1,0],[1,,,,1],[,1,1,1,0],[1,,,,1],[,1,1,1,0]],9:[[,1,1,1,0],[1,,,,1],[,1,1,1,1],[,,,,1],[,1,1,1,0]],0:[[,1,1,1,0],[1,,,,1],[1,,,,1],[1,,,,1],[,1,1,1,0]],A:[[1,1,1,1,1],[1,,,,1],[1,1,1,1,1],[1,,,,1],[1,,,,1]],B:[[1,1,1,1,0],[1,,,1,0],[1,1,1,1,1],[1,,,,1],[1,1,1,1,1]],C:[[1,1,1,1,1],[1,,,,0],[1,,,,0],[1,,,,0],[1,1,1,1,1]],D:[[1,1,1,,0],[1,,,1,0],[1,,,,1],[1,,,,1],[1,1,1,1,1]],E:[[1,1,1,1,1],[1,,,,0],[1,1,1,,0],[1,,,,0],[1,1,1,1,1]],F:[[1,1,1,1,1],[1,,,,0],[1,1,1,,0],[1,,,,0],[1,,,,0]],G:[[1,1,1,1,1],[1,,,,0],[1,,1,1,1],[1,,,,1],[1,1,1,1,1]],
H:[[1,,,,1],[1,,,,1],[1,1,1,1,1],[1,,,,1],[1,,,,1]],I:[[1,1,1,1,1],[,,1,,0],[,,1,,0],[,,1,,0],[1,1,1,1,1]],J:[[,,,,1],[,,,,1],[,,,,1],[1,,,,1],[1,1,1,1,1]],K:[[1,,,1,0],[1,,1,,0],[1,1,1,,0],[1,,,1,0],[1,,,,1]],L:[[1,,,,0],[1,,,,0],[1,,,,0],[1,,,,0],[1,1,1,1,1]],M:[[1,,,,1],[1,1,,1,1],[1,,1,,1],[1,,,,1],[1,,,,1]],N:[[1,,,,1],[1,1,,,1],[1,,1,,1],[1,,,1,1],[1,,,,1]],O:[[1,1,1,1,1],[1,,,,1],[1,,,,1],[1,,,,1],[1,1,1,1,1]],P:[[1,1,1,1,1],[1,,,,1],[1,1,1,1,1],[1,,,,0],[1,,,,0]],Q:[[1,1,1,1,0],[1,,,1,0],[1,,,1,0],[1,,,1,0],[1,1,1,1,1]],R:[[1,1,1,1,1],[1,,,,1],[1,1,1,1,1],[1,,,1,0],[1,,,,1]],S:[[1,1,1,1,1],[1,,,,0],[1,1,1,1,1],[,,,,1],[1,1,1,1,1]],T:[[1,1,1,1,1],[,,1,,0],[,,1,,0],[,,1,,0],[,,1,,0]],U:[[1,,,,1],[1,,,,1],[1,,,,1],[1,,,,1],[1,1,1,1,1]],V:[[1,,,,1],[1,,,,1],[1,,,,1],[,1,,1,0],[,,1,,0]],W:[[1,,,,1],[1,,,,1],[1,,1,,1],[1,1,,1,1],[1,,,,1]],X:[[1,,,,1],[,1,,1,0],[,,1,,0],[,1,,1,0],[1,,,,1]],Y:[[1,,,,1],[1,,,,1],[1,1,1,1,1],[,,1,,0],[,,1,,0]],Z:[[1,1,1,1,1],[,,,1,0],[,,1,,0],[,1,,,0],[1,1,1,1,1]]," ":[[,,,,0],[,,,,0],[,,,,0],[,,,,0],[,,,,0]],",":[[,,,,0],[,,,,0],[,,,,0],[,,1,,0],[,,1,,0]],"+":[[,,,,0],[,,1,,0],[,1,1,1,0],[,,1,,0],[,,,,0]],"/":[[,,,,1],[,,,1,0],[,,1,,0],[,1,,,0],[1,,,,0]],":":[[,,,,0],[,,1,,0],[,,,,0],[,,1,,0],[,,,,0]],"@":[[1,1,1,1,1],[,,,,1],[1,1,1,,1],[1,,1,,1],[1,1,1,1,1]],x:[[1,,1,,1],[,1,,1,0],[1,,1,,1],[,1,,1,0],[1,,1,,1]],z:[[,1,,1,0],[1,,1,,1],[,1,,1,0],[1,,1,,1],[,1,,1,0]],o:[[1,1,1,1,1],[1,,,,1],[1,,1,,1],[1,,,,1],[1,1,1,1,1]],e:[[1,,,,0],[1,1,,,0],[1,1,1,,0],[1,1,1,1,0],[1,1,1,1,1]],w:[[,,,,1],[,,,1,1],[,,1,1,1],[,1,1,1,1],[1,1,1,1,1]],s:[[1,1,1,1,1],[,1,1,1,1],[,,1,1,1],[,,,1,1],[,,,,1]],d:[[1,1,1,1,1],[1,1,1,1,0],[1,1,1,,0],[1,1,,,0],[1,,,,0]],t:[[0,0,0,1,1],[0,0,1,1,1],[0,0,1,1,1],[0,0,1,1,1],[0,0,1,1,1]],y:[[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1]],u:[[1,1,0,0,0],[1,1,1,0,0],[0,0,1,0,0],[0,1,1,0,0],[1,1,1,0,0]],g:[[0,0,1,1,1],[0,0,0,1,1],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,1]],h:[[1,1,1,1,1],[1,1,1,1,1],[0,1,1,1,0],[1,1,1,1,1],[1,1,1,1,1]],j:[[1,1,1,0,0],[1,1,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[1,1,1,1,1]],b:[[0,0,0,1,1],[0,0,0,1,1],[0,0,0,0,1],[0,0,0,0,1],[0,0,0,0,1]],n:[[1,1,1,1,1],[1,1,1,1,1],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]],m:[[1,1,1,1,1],[1,0,0,1,1],[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0]]}};Txt={textLine:function(a){gl=a.glitch||{};for(var b=a.text.length,c=5,d=0;b>d;d++)for(var e=S.letters[a.text.charAt(d)]||S.letters.unknown,f=0;c>f;f++)for(var g=0;c>g;g++)if(1===e[f][g]){var h=(Math.random()<gl.xch||0)*(Math.random()-.5)*gl.xamt||0,i=(Math.random()<gl.ych||0)*(Math.random()-.5)*gl.yamt||0;a.ctx.fillRect(a.x+g*a.scale+h+(c*a.scale+a.hspacing)*d,a.y+f*a.scale+i,a.scale,a.scale)}},text:function(a){var b=5,c=b*a.scale,d=a.text.split("\n"),e=d.slice(0),f=d.length,g=e.sort(function(a,b){return b.length-a.length})[0],h=g.length*c+(g.length-1)*a.hspacing,i=f*c+(f-1)*a.vspacing,j=a.x,k=a.y,l=a.x+h,m=a.y+i;"center"==a.halign?(j=a.x-h/2,l=a.x+h/2):"right"==a.halign&&(j=a.x-h,l=a.x),"center"==a.valign?(k=a.y-i/2,m=a.y+i/2):"bottom"==a.valign&&(k=a.y-i,m=a.y);var n=j+h/2,o=k+i/2;if(a.render)for(var p=0;f>p;p++){var q=d[p],r=q.length*c+(q.length-1)*a.hspacing,s=a.x,t=a.y+(c+a.vspacing)*p;"center"==a.halign?s=a.x-r/2:"right"==a.halign&&(s=a.x-r),"center"==a.valign?t-=i/2:"bottom"==a.valign&&(t-=i),a.snap&&(s=Math.floor(s),t=Math.floor(t)),this.textLine({ctx:a.ctx,x:s,y:t,text:q,hspacing:a.hspacing||0,scale:a.scale||1,glitch:a.glitch})}return{sx:j,sy:k,cx:n,cy:o,ex:l,ey:m,width:h,height:i}}};function T(){this.inUse=!1,this.init=function(){this.body=new Entity({dead:!0,gravity:0}),this.body.setCoords(-1e3,-1e3)},T.prototype.spawn=function(a){this.inUse=!0,this.type=a.type,this.text=a.text,this.ctx=a.ctx,this.life=a.life||1,this.remaining=a.life||1,this.body.radius=a.radius||1,this.body.collides=a.collides||!1,this.body.mapcollide=a.mapcollide||!1,this.color=a.color||"#fff",this.asplode=a.asplode,this.body.dead=!1,this.dead=!1,this.body.setCoords(a.x,a.y),this.body.dx=a.dx||0,this.body.dy=a.dy||0,this.body.gravity=a.gravity||0,this.body.type=a.type||"particle"},T.prototype.use=function(a){return this.dead?(U("default",this.body),U("smoke",this.body),!0):(this.remaining-=a,this.remaining>0?(this.render(A),this.body.dx+=Math.random()*r.GLITCH.xch-r.GLITCH.xch/2,this.body.dy+=Math.random()*r.GLITCH.xch-r.GLITCH.xch/2,this.body.update(),!1):(this.dead=!0,!0))},T.prototype.clear=function(){this.inUse=!1,this.body.xx=-1e3,this.body.xx=-1e3,this.body.dead=!0,this.body.collides=!1,this.body.mapcollide=!1},T.prototype.render=function(a){var b=this.body;switch(this.ctx&&(a=this.ctx),this.type){case"glitch":a.save(),d||(a.globalCompositeOperation="screen"),a.fillStyle="#"+J("5678890ABCDE",3),a.strokeStyle=this.stroke;var c=this.body.radius*(this.remaining/this.life);a.fillRect(b.xx,b.yy-c,2*c,2*c),a.restore();break;case"text":a.fillStyle=this.color,Txt.text({ctx:C,x:b.xx,y:b.yy,text:"o",hspacing:2,vspacing:5,halign:"center",valign:"top",scale:1,snap:1,render:1});break;case"smoke":var e=this.remaining/this.life;a.fillStyle="rgba(200,200,200,"+e+")",a.fillRect(b.xx-this.body.radius,b.yy-this.body.radius,2*this.body.radius,2*this.body.radius);break;default:a.save(),d||(a.globalCompositeOperation="screen"),a.fillStyle=this.color||"#fff",a.strokeStyle=this.stroke;var c=this.body.radius*(this.remaining/this.life);a.fillRect(b.xx,b.yy-c,2*c,2*c),a.globalCompositeOperation="source-over",a.restore()}}}function U(a,b){switch(a){default:for(var c=20;c--;)o.get({x:b.xx||100,y:b.yy||100,mapcollide:!1,dy:2*Math.random()-1,dx:2*Math.random()-1,radius:3,color:"#e80",life:.25});break;case"enemy":for(var c=10;c--;)o.get({x:b.xx||100,y:b.yy||100,mapcollide:!1,gravity:.03,dy:2*Math.random()-1,dx:2*Math.random()-1,radius:3,color:"#800",life:.2});break;case"smoke":for(var c=10;c--;)o.get({x:b.xx+6*Math.random()-3||100,y:b.yy+6*Math.random()-3||100,mapcollide:!1,type:"smoke",gravity:-.003,dy:Math.random()*-.1,dx:.1*Math.random()-.05,radius:5,life:.75})}}function V(a,b){var c=a,d=[];this.init=function(){for(var a=0;c>a;a++){var e=new b;e.init(),d[a]=e}},this.get=function(a){return d[c-1].inUse?void 0:(d[c-1].spawn(a),d.unshift(d.pop()),d[c-1])},this.getPool=function(){return d},this.use=function(){for(var a=0;c>a&&d[a].inUse;a++)d[a].use(h)&&(d[a].clear(),d.push(d.splice(a,1)[0]))}}Entity=function(a){a||(a={radius:10,gravity:0,frictX:.92,frictY:.94}),this.cx=0,this.cy=0,this.xr=0,this.yr=0,this.xx=0,this.yy=0,this.dx=0,this.dy=0,this.collided=!1,this.ox=0,this.oy=0,this.radius=a.radius||10,this.gravity=a.gravity||0,this.bounce=a.bounce||0,this.frictX=a.frictX||.92,this.frictY=a.frictY||.94,this.dead=!1,this.collides=a.collides||0,this.mapcollide=a.mapcollide||0,this.id=Math.random()},Entity.prototype.setCoords=function(a,b){this.xx=a,this.yy=b,this.cx=Math.floor(this.xx/r.GRID),this.cy=Math.floor(this.yy/r.GRID),this.xr=(this.xx-this.cx*r.GRID)/r.GRID,this.yr=(this.yy-this.cy*r.GRID)/r.GRID},Entity.prototype.hasCollision=function(a,b){return this.mapcollide?void 0==S.map[b]||void 0==S.map[b][a]?!1:S.map[b][a]:!1},Entity.prototype.overlaps=function(a,b){var c=a.radius+b.radius,d=(b.xx-a.xx)*(b.xx-a.xx)+(b.yy-a.yy)*(b.yy-a.yy);return d>c*c?!1:!0},Entity.prototype.onGround=function(){return this.hasCollision(this.cx,this.cy+1)&&this.yr>=.5},Entity.prototype.onCeiling=function(){return this.hasCollision(this.cx,this.cy-1)&&this.yr<=.5},Entity.prototype.onWallLeft=function(){return this.hasCollision(this.cx-1,this.cy)&&this.xr<=.5},Entity.prototype.onWallRight=function(){return this.hasCollision(this.cx+1,this.cy)&&this.xr>=.5},Entity.prototype.update=function(){for(this.xr+=this.dx,this.dx*=this.frictX,this.hasCollision(this.cx-1,this.cy)&&this.xr<=.3&&(this.dx=0,this.xr=.3),this.hasCollision(this.cx+1,this.cy)&&this.xr>=.7&&(this.dx=0,this.xr=.7);this.xr<0;)this.cx--,this.xr++;for(;this.xr>1;)this.cx++,this.xr--;for(this.dy+=this.gravity,this.yr+=this.dy,this.dy*=this.frictY,this.hasCollision(this.cx,this.cy-1)&&this.yr<=.4&&(this.dy=0,this.yr=.4),this.hasCollision(this.cx,this.cy+1)&&this.yr>=.7&&(this.dy=this.bounce?-this.dy:0,this.bounce||(this.yr=.7));this.yr<0;)this.cy--,this.yr++;for(;this.yr>1;)this.cy++,this.yr--;this.xx=Math.floor((this.cx+this.xr)*r.GRID),this.yy=Math.floor((this.cy+this.yr)*r.GRID),this.ox=(this.cx+this.xr)*r.GRID,this.oy=(this.cy+this.yr)*r.GRID},Entity.prototype.collide=function(a,b){var c=Math.sqrt((a.xx-b.xx)*(a.xx-b.xx)+(a.yy-b.yy)*(a.yy-b.yy));if(c<=a.radius+b.radius){this.collided=!0;var d=Math.atan2(a.yy-b.yy,a.xx-b.xx),f=.03,g=(b.radius+a.radius-c)/(b.radius+a.radius);this.dx-=Math.cos(d)*g*f,this.dy-=Math.sin(d)*g*f,e.dx+=Math.cos(d)*g*f,e.dy+=Math.sin(d)*g*f}};var W={},X=44100,Y=2,Z=33,$=null;function _(a){return Math.sin(6.283184*a)}function aa(a){return _(a)<0?-1:1}function ba(a){return a%1-.5}function ca(a){var b=a%1*4;return 2>b?b-1:3-b}var da=[_,aa,ba,ca];function ea(a){return.00390625*Math.pow(1.059463094,a-128)}function fa(a,b){setTimeout(function(){var c=new Uint8Array(a*Y*2),d=c.length-2,e=function(){for(var a=new Date,f=0;d>=0;)if(c[d]=0,c[d+1]=128,d-=2,f+=1,f%1e3===0&&new Date-a>Z)return void setTimeout(e,0);setTimeout(function(){b(c)},0)};setTimeout(e,0)},0)}function ga(a,b,c,d,e){var f=c.fx_delay_time*d>>1,g=c.fx_delay_amt/255,h=0,i=function(){for(var c=new Date,d=0;b-f>h;){var j=4*h,k=4*(h+f),l=a[k]+(a[k+1]<<8)+(a[j+2]+(a[j+3]<<8)-32768)*g;if(a[k]=255&l,a[k+1]=l>>8&255,l=a[k+2]+(a[k+3]<<8)+(a[j]+(a[j+1]<<8)-32768)*g,a[k+2]=255&l,a[k+3]=l>>8&255,++h,d+=1,d%1e3===0&&new Date-c>Z)return void setTimeout(i,0)}setTimeout(e,0)};setTimeout(i,0)}W.AudioGenerator=function(a){this.mixBuf=a,this.waveSize=a.length/Y/2},W.AudioGenerator.prototype.getWave=function(){var a,b,c,d,e,f,g,h=this.mixBuf,i=this.waveSize,j=i*Y*2;for(e=j-8,f=e-36,d=String.fromCharCode(82,73,70,70,255&e,e>>8&255,e>>16&255,e>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&f,f>>8&255,f>>16&255,f>>24&255),a=0;j>a;){for(c="",b=0;256>b&&j>a;++b,a+=2)g=4*(h[a]+(h[a+1]<<8)-32768),g=-32768>g?-32768:g>32767?32767:g,c+=String.fromCharCode(255&g,g>>8&255);d+=c}return d},W.AudioGenerator.prototype.getAudio=function(){var a=this.getWave(),b=new Audio("data:audio/wav;base64,"+btoa(a));return b.preload="none",b.load(),b},W.AudioGenerator.prototype.getAudioBuffer=function(a){null===$&&($=new AudioContext);var b=this.mixBuf,c=this.waveSize,d=c*Y*2,e=$.createBuffer(Y,this.waveSize,X),f=e.getChannelData(0),g=e.getChannelData(1),h=0,i=function(){for(var c=new Date,j=0;d/2>h;){var k=4*(b[4*h]+(b[4*h+1]<<8)-32768);if(k=-32768>k?-32768:k>32767?32767:k,f[h]=k/32768,k=4*(b[4*h+2]+(b[4*h+3]<<8)-32768),k=-32768>k?-32768:k>32767?32767:k,g[h]=k/32768,h+=1,j+=1,j%1e3===0&&new Date-c>Z)return void setTimeout(i,0)}setTimeout(function(){a(e)},0)};setTimeout(i,0)},W.SoundGenerator=function(a,b){this.instr=a,this.rowLen=b||5605,this.osc_lfo=da[a.lfo_waveform],this.osc1=da[a.osc1_waveform],this.osc2=da[a.osc2_waveform],this.attack=a.env_attack,this.sustain=a.env_sustain,this.release=a.env_release,this.panFreq=Math.pow(2,a.fx_pan_freq-8)/this.rowLen,this.lfoFreq=Math.pow(2,a.lfo_freq-8)/this.rowLen},W.SoundGenerator.prototype.genSound=function(a,b,c){for(var d=(new Date,0),e=0,f=ea(a+12*(this.instr.osc1_oct-8)+this.instr.osc1_det)*(1+8e-4*this.instr.osc1_detune),g=ea(a+12*(this.instr.osc2_oct-8)+this.instr.osc2_det)*(1+8e-4*this.instr.osc2_detune),h=this.instr.fx_resonance/255,i=0,j=0,k=this.attack+this.sustain+this.release-1;k>=0;--k){var l=k+c,m=this.osc_lfo(l*this.lfoFreq)*this.instr.lfo_amt/512+.5,n=1;k<this.attack?n=k/this.attack:k<this.attack+this.sustain||(n-=(k-this.attack-this.sustain)/this.release);var o=f;this.instr.lfo_osc1_freq&&(o+=m),this.instr.osc1_xenv&&(o*=n*n),d+=o;var p=this.osc1(d)*this.instr.osc1_vol;o=g,this.instr.osc2_xenv&&(o*=n*n),e+=o,p+=this.osc2(e)*this.instr.osc2_vol,this.instr.noise_fader&&(p+=(2*Math.random()-1)*this.instr.noise_fader*n),p*=n/255;var q=this.instr.fx_freq;this.instr.lfo_fx_freq&&(q*=m),q=1.5*Math.sin(3.141592*q/X),i+=q*j;var r=h*(p-j)-i;switch(j+=q*r,this.instr.fx_filter){case 1:p=r;break;case 2:p=i;break;case 3:p=j;break;case 4:p=i+r}if(o=_(l*this.panFreq)*this.instr.fx_pan_amt/512+.5,p*=39*this.instr.env_master,l=4*l,l+3<b.length){var s=b[l]+(b[l+1]<<8)+p*(1-o);b[l]=255&s,b[l+1]=s>>8&255,s=b[l+2]+(b[l+3]<<8)+p*o,b[l+2]=255&s,b[l+3]=s>>8&255}}},W.SoundGenerator.prototype.getAudioGenerator=function(a,b){var c=this.attack+this.sustain+this.release-1+32*this.rowLen,d=this;fa(c,function(e){d.genSound(a,e,0),ga(e,c,d.instr,d.rowLen,function(){b(new W.AudioGenerator(e))})})},W.SoundGenerator.prototype.createAudio=function(a,b){this.getAudioGenerator(a,function(a){b(a.getAudio())})},W.SoundGenerator.prototype.createAudioBuffer=function(a,b){this.getAudioGenerator(a,function(a){a.getAudioBuffer(b)})},W.MusicGenerator=function(a){this.song=a,this.waveSize=X*a.songLen},W.MusicGenerator.prototype.generateTrack=function(a,b,c){var d=this;fa(this.waveSize,function(e){var f=d.waveSize,g=d.waveSize*Y*2,h=d.song.rowLen,i=d.song.endPattern,j=new W.SoundGenerator(a,h),k=0,l=0,m=0,n=function(){for(var b=new Date;;)if(32!==m){if(l===i-1)return void setTimeout(o,0);var c=a.p[l];if(c){var d=a.c[c-1].n[m];d&&j.genSound(d,e,k)}if(k+=h,m+=1,new Date-b>Z)return void setTimeout(n,0)}else m=0,l+=1},o=function(){ga(e,f,a,h,q)},p=0,q=function(){for(var a=new Date,d=0;g>p;){var f=b[p]+(b[p+1]<<8)+e[p]+(e[p+1]<<8)-32768;if(b[p]=255&f,b[p+1]=f>>8&255,p+=2,d+=1,d%1e3===0&&new Date-a>Z)return void setTimeout(q,0)}setTimeout(c,0)};setTimeout(n,0)})},W.MusicGenerator.prototype.getAudioGenerator=function(a){var b=this;fa(this.waveSize,function(c){var d=0,e=function(){d<b.song.songData.length?(d+=1,b.generateTrack(b.song.songData[d-1],c,e)):a(new W.AudioGenerator(c))};e()})},W.MusicGenerator.prototype.createAudio=function(a){this.getAudioGenerator(function(b){a(b.getAudio())})},W.MusicGenerator.prototype.createAudioBuffer=function(a){this.getAudioGenerator(function(b){b.getAudioBuffer(a)})},window.onload=L()}();
</script></body></html>